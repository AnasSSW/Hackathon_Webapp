@model Hackathon.ViewModels.HomeViewModel
@{
    ViewData["Title"] = "Home Page";
}

<div class="main-section">

    <!-- Matched Posts Section -->
    @if (Model.MatchedPosts.Any(p => !p.IsClosed))
    {
        <h2 class="section-title">โพสต์ที่ตรงกับทักษะของคุณ</h2>
        <div class="container">
            @foreach (var post in Model.MatchedPosts.Where(p => !p.IsClosed))
            {
                <div class="card">
                    <a asp-controller="Post" asp-action="Details" asp-route-id="@post.Id">
                        <img src="@(post.ImageUrl ?? "https://placehold.co/200x150/CCCCCC/FFFFFF?text=No+Image")" alt="@post.Title">
                    </a>
                    <a asp-controller="Post" asp-action="Details" asp-route-id="@post.Id" class="card-title-link">
                        <h3>@post.Title</h3>
                    </a>
                    <p class="author-name">โดย: @(post.Author?.FirstName ?? "N/A")</p>
                    @if (post.RequiredExpertise != null)
                    {
                        <div class="expertise-tags">
                            @foreach (var tag in post.RequiredExpertise.Split(',', StringSplitOptions.RemoveEmptyEntries).Select(s => s.Trim()))
                            {
                                <span class="badge bg-secondary">@tag</span>
                            }
                        </div>
                    }
                    <a asp-controller="Post" asp-action="Details" asp-route-id="@post.Id" class="join-button">เข้าร่วมทีม</a>
                </div>
            }
        </div>
        <hr class="section-divider" />
    }

    <!-- All Posts Section -->
    <h2 class="section-title">โพสต์ทั้งหมด</h2>
    <div class="container">
        @if (Model.AllPosts.Any(p => !p.IsClosed))
        {
            @foreach (var post in Model.AllPosts.Where(p => !p.IsClosed))
            {
                <div class="card">
                    <a asp-controller="Post" asp-action="Details" asp-route-id="@post.Id">
                        <img src="@(post.ImageUrl ?? "https://placehold.co/200x150/CCCCCC/FFFFFF?text=No+Image")" alt="@post.Title">
                    </a>
                    <a asp-controller="Post" asp-action="Details" asp-route-id="@post.Id" class="card-title-link">
                        <h3>@post.Title</h3>
                    </a>
                    <p class="author-name">โดย: @(post.Author?.FirstName ?? "N/A")</p>
                    @if (post.RequiredExpertise != null)
                    {
                        <div class="expertise-tags">
                            @foreach (var tag in post.RequiredExpertise.Split(',', StringSplitOptions.RemoveEmptyEntries).Select(s => s.Trim()))
                            {
                                <span class="badge bg-secondary">@tag</span>
                            }
                        </div>
                    }
                    <a asp-controller="Post" asp-action="Details" asp-route-id="@post.Id" class="join-button">เข้าร่วมทีม</a>
                </div>
            }
        }
        else
        {
            <p class="no-posts-message">ยังไม่มีโพสต์ที่เปิดรับสมัครในระบบ ลองสร้างโพสต์ใหม่ดูสิ!</p>
        }
    </div>
</div>

@section Styles {
    <link rel="stylesheet" href="~/css/card-style.css" asp-append-version="true" />
}
