@section Styles {
    <link rel="stylesheet" href="~/css/new-details.css" asp-append-version="true" />
    <style>
        .expertise-tags .tag {
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.4em 0.8em;
            margin-right: 5px;
            margin-bottom: 5px;
            border-radius: 9999px;
            background-color: #e5e7eb;
            color: #4b5563;
            display: inline-block;
        }

        .post-status {
            font-weight: 600;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            display: inline-block;
        }

        /* สถานะ */
        .status-open {
            background-color: #34d399; /* เขียว */
            color: #fff;
        }

        .status-closed {
            background-color: #d1d5db; /* เทา */
            color: #1f2937;
        }

        .status-expired {
            background-color: #f87171; /* แดง */
            color: #fff;
        }

        /* Mobile responsiveness for the table */
        @media (max-width: 768px) {
            .participants-table thead

        {
            display: none;
        }

        .participants-table tr {
            display: block;
            margin-bottom: 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .participants-table td {
            display: block;
            text-align: right;
            padding-left: 50%;
            position: relative;
        }

            .participants-table td::before {
                content: attr(data-label);
                position: absolute;
                left: 1rem;
                width: calc(50% - 1.5rem);
                text-align: left;
                font-weight: 600;
            }

        }
    </style>
}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const daysEl = document.getElementById("daysRemaining");
        const timeRemainingContainer = daysEl?.parentNode;
        const statusEl = document.getElementById("postStatus");
        const isClosed = @(Model.IsClosed ? "true" : "false");

        function updateStatus() {
            statusEl.classList.remove("status-open", "status-closed", "status-expired");

            if (isClosed) {
                if (daysEl) daysEl.innerText = "- วัน";
                statusEl.innerText = "ปิดใช้งาน";
                statusEl.classList.add("status-closed");
                return;
            }

            const expirationStr = '@Model.ExpirationDate?.ToString("o")';
            const expiration = expirationStr ? new Date(expirationStr) : null;
            const now = new Date();

            if (!expiration || expiration - now <= 0) {
                if (daysEl) daysEl.innerText = "หมดอายุ";
                statusEl.innerText = "ปิดใช้งาน";
                statusEl.classList.add("status-expired");
            } else {
                const diffMs = expiration - now;
                const days = Math.floor(diffMs / (1000 * 60 * 60 * 24));
                if (daysEl) daysEl.innerText = `${days} วัน`;
                statusEl.innerText = "เปิดใช้งาน";
                statusEl.classList.add("status-open");
            }
        }

        updateStatus();
        setInterval(updateStatus, 60 * 1000);
    });
</script>
